# utils/recipes.py
# -*- coding: utf-8 -*-
from typing import Dict, List


# 발달장애인이 단독/보조하에 하기 쉬운, 최대한 단순화된 레시피 모음
# - 도구: 손에 잡히는 최소 도구만
# - 재료: 핵심 재료 위주 (양념은 최소화)
# - 순서: 1문장 1행, 시간/불 세기 간단하게

BASE_RECIPES: Dict[str, Dict] = {
    # ───────────── 기본 계란/밥류 ─────────────
    "간장계란밥": {
        "도구": ["그릇", "프라이팬", "아빠숟가락"],
        "재료": ["밥", "계란", "간장", "식용유"],
        "순서": [
            "① 그릇에 따뜻한 밥을 담아요.",
            "② 프라이팬을 약불로 켜요.",
            "③ 프라이팬에 식용유를 아빠숟가락으로 1숟가락 넣어요.",
            "④ 계란을 깨서 프라이팬에 넣어요.",
            "⑤ 흰자가 하얗게 될 때까지 2~3분 익혀요.",
            "⑥ 계란을 그릇에 있는 밥 위에 살짝 올려요.",
            "⑦ 간장을 아빠숟가락으로 1숟가락 밥 위에 뿌려요.",
            "⑧ 숟가락으로 밥과 계란을 잘 비벼서 먹어요.",
        ],
    },
    "계란후라이": {
        "도구": ["프라이팬", "뒤집개", "접시", "아빠숟가락"],
        "재료": ["계란", "식용유", "소금"],
        "순서": [
            "① 프라이팬을 약불로 켜요.",
            "② 식용유를 아빠숟가락으로 1숟가락 넣어요.",
            "③ 계란을 조심히 깨서 프라이팬에 넣어요.",
            "④ 흰자가 하얗게 될 때까지 2~3분 그대로 두어요.",
            "⑤ 노른자를 더 익히고 싶으면 뚜껑을 덮고 1분 더 익혀요.",
            "⑥ 뒤집개로 조심히 들어 올려 접시에 옮겨 담아요.",
            "⑦ 소금을 조금만 뿌려요.",
        ],
    },
    "스크램블에그": {
        "도구": ["볼", "젓가락", "프라이팬", "아빠숟가락"],
        "재료": ["계란", "우유(선택)", "식용유", "소금"],
        "순서": [
            "① 볼에 계란 2개를 깨서 넣어요.",
            "② 우유를 조금(아빠숟가락 1숟가락 정도) 넣어요. (선택)",
            "③ 젓가락으로 계란을 골고루 섞어요.",
            "④ 프라이팬을 약불로 켜요.",
            "⑤ 식용유를 아빠숟가락으로 1숟가락 넣어요.",
            "⑥ 계란물을 프라이팬에 붓고, 나무주걱이나 젓가락으로 천천히 저어요.",
            "⑦ 계란이 몽글몽글해지면 불을 꺼요.",
            "⑧ 소금을 조금만 뿌려요.",
        ],
    },
    "밥버터간장": {
        "도구": ["그릇", "아빠숟가락"],
        "재료": ["밥", "버터", "간장"],
        "순서": [
            "① 그릇에 따뜻한 밥을 담아요.",
            "② 버터를 아빠숟가락으로 1숟가락 밥 위에 올려요.",
            "③ 간장을 아빠숟가락으로 1숟가락 밥 위에 뿌려요.",
            "④ 숟가락으로 밥과 버터와 간장을 골고루 비벼요.",
        ],
    },

    # ───────────── 라면/국물류 ─────────────
    "라면": {
        "도구": ["냄비", "가스레인지", "종이컵", "젓가락"],
        "재료": ["라면", "물"],
        "순서": [
            "① 냄비를 준비해요.",
            "② 물을 종이컵으로 2컵 넣어요.",
            "③ 냄비를 가스레인지 위에 올려요.",
            "④ 불을 중불로 켜요.",
            "⑤ 물이 끓을 때까지 5분 정도 기다려요.",
            "⑥ 라면 면을 넣어요.",
            "⑦ 라면 스프를 모두 넣어요.",
            "⑧ 젓가락으로 가볍게 저어요.",
            "⑨ 3~4분 동안 끓여요.",
            "⑩ 불을 끄고 그릇에 라면을 옮겨 담아요.",
        ],
    },
    "떡국": {
        "도구": ["냄비", "가스레인지", "종이컵", "국자"],
        "재료": ["떡국떡", "떡국용 국물(시판)", "물"],
        "순서": [
            "① 냄비에 물을 종이컵으로 2컵 넣어요.",
            "② 떡국떡을 한 주먹 넣어요.",
            "③ 불을 중불로 켜요.",
            "④ 떡이 말랑해질 때까지 5~7분 끓여요.",
            "⑤ 시판 떡국 국물을 설명서 양대로 넣어요.",
            "⑥ 한 번 더 끓으면 불을 꺼요.",
            "⑦ 그릇에 옮겨 담아요.",
        ],
    },
    "미역국": {
        "도구": ["냄비", "가스레인지", "종이컵", "아빠숟가락"],
        "재료": ["건미역", "국간장", "참기름", "물"],
        "순서": [
            "① 건미역을 찬물에 5분 정도 불려요.",
            "② 불린 미역을 한 번 헹구고 물기를 살짝 짜요.",
            "③ 냄비에 참기름을 아빠숟가락 1숟가락 넣고 약불로 켜요.",
            "④ 미역을 넣고 1~2분 정도 볶아요.",
            "⑤ 물을 종이컵으로 3컵 넣어요.",
            "⑥ 중불로 끓이다가, 끓기 시작하면 국간장을 아빠숟가락 1숟가락 넣어요.",
            "⑦ 5분 정도 더 끓이고 불을 꺼요.",
        ],
    },
    "된장찌개": {
        "도구": ["냄비", "가스레인지", "종이컵", "아빠숟가락"],
        "재료": ["된장", "애호박(선택)", "두부(선택)", "물"],
        "순서": [
            "① 냄비에 물을 종이컵으로 3컵 넣어요.",
            "② 된장을 아빠숟가락으로 1~2숟가락 넣어요.",
            "③ 중불로 불을 켜고 된장을 숟가락으로 풀어요.",
            "④ 애호박과 두부를 한 입 크기로 잘라 넣어요. (선택)",
            "⑤ 끓기 시작하면 5분 정도 더 끓여요.",
            "⑥ 불을 끄고 그릇에 옮겨 담아요.",
        ],
    },
    "김치찌개(간단)": {
        "도구": ["냄비", "가스레인지", "종이컵", "아빠숟가락"],
        "재료": ["묵은 김치", "참치캔 또는 햄", "물", "고춧가루(선택)"],
        "순서": [
            "① 냄비에 묵은 김치를 한 주먹 넣어요.",
            "② 참치캔 또는 잘게 썬 햄을 넣어요.",
            "③ 물을 종이컵으로 2~3컵 넣어요.",
            "④ 중불로 불을 켜요.",
            "⑤ 끓기 시작하면 5~10분 정도 끓여요.",
            "⑥ 매운맛을 더 원하면 고춧가루를 아빠숟가락 반 숟가락 넣어요.",
        ],
    },

    # ───────────── 카레/볶음류 ─────────────
    "카레": {
        "도구": ["칼", "도마", "냄비", "숟가락", "종이컵", "아빠숟가락"],
        "재료": ["시판 카레블록 또는 카레가루", "감자", "당근", "양파", "물"],
        "순서": [
            "① 감자 1개 껍질을 벗기고 작게 잘라요.",
            "② 당근 반 개 껍질을 벗기고 작게 잘라요.",
            "③ 양파 반 개 껍질을 벗기고 작게 잘라요.",
            "④ 냄비에 식용유를 아빠숟가락 1숟가락 넣고 중불로 켜요.",
            "⑤ 자른 감자, 당근, 양파를 넣고 3분 정도 볶아요.",
            "⑥ 물을 종이컵으로 3컵 넣어요.",
            "⑦ 끓기 시작하면 카레블록(또는 가루)을 설명서 양대로 넣어요.",
            "⑧ 약불로 줄이고 5~10분 저으면서 끓여요.",
        ],
    },
    "김치볶음밥": {
        "도구": ["프라이팬", "주걱", "그릇", "아빠숟가락"],
        "재료": ["밥", "김치", "식용유", "김가루(선택)"],
        "순서": [
            "① 김치를 가위로 잘게 잘라요.",
            "② 프라이팬을 중불로 켜요.",
            "③ 식용유를 아빠숟가락 1숟가락 넣어요.",
            "④ 김치를 넣고 2~3분 볶아요.",
            "⑤ 밥을 넣고 주걱으로 섞으며 3분 더 볶아요.",
            "⑥ 간이 싱거우면 김치 국물을 조금 넣어요.",
            "⑦ 그릇에 담고 김가루를 위에 뿌려요. (선택)",
        ],
    },
    "참치마요덮밥": {
        "도구": ["그릇", "아빠숟가락"],
        "재료": ["밥", "참치캔", "마요네즈", "간장", "김가루(선택)"],
        "순서": [
            "① 그릇에 따뜻한 밥을 담아요.",
            "② 참치캔을 열고 기름을 살짝 따라 버려요.",
            "③ 밥 위에 참치를 올려요.",
            "④ 마요네즈를 아빠숟가락 1~2숟가락 뿌려요.",
            "⑤ 간장을 아빠숟가락 반 숟가락 정도만 뿌려요.",
            "⑥ 김가루를 위에 뿌려요. (선택)",
        ],
    },
    "주먹밥": {
        "도구": ["볼", "비닐장갑", "아빠숟가락"],
        "재료": ["밥", "참치 또는 햄", "김가루", "참기름"],
        "순서": [
            "① 볼에 따뜻한 밥을 넣어요.",
            "② 잘게 썬 햄 또는 참치를 넣어요.",
            "③ 김가루를 넣어요.",
            "④ 참기름을 아빠숟가락 반 숟가락 넣어요.",
            "⑤ 비닐장갑을 끼고 손으로 골고루 섞어요.",
            "⑥ 한 입 크기로 동그랗게 뭉쳐요.",
        ],
    },

    # ───────────── 떡볶이/구이류 ─────────────
    "떡볶이": {
        "도구": ["냄비", "가스레인지", "종이컵", "주걱", "가위"],
        "재료": ["떡볶이 떡", "어묵", "고추장", "설탕(선택)", "물"],
        "순서": [
            "① 어묵을 가위로 한 입 크기로 잘라요.",
            "② 냄비에 떡볶이 떡과 어묵을 넣어요.",
            "③ 물을 종이컵으로 2컵 넣어요.",
            "④ 고추장을 아빠숟가락 1~2숟가락 넣어요.",
            "⑤ 단맛을 원하면 설탕을 아빠숟가락 반 숟가락 넣어요.",
            "⑥ 중불로 불을 켜고 주걱으로 잘 저어요.",
            "⑦ 떡이 말랑해질 때까지 5~10분 끓여요.",
        ],
    },
    "삼겹살구이": {
        "도구": ["프라이팬", "집게", "가위", "접시"],
        "재료": ["삼겹살", "소금"],
        "순서": [
            "① 프라이팬을 중불로 예열해요.",
            "② 삼겹살을 프라이팬에 올려요.",
            "③ 한쪽 면이 노릇해질 때까지 3~4분 굽어요.",
            "④ 집게와 가위로 먹기 좋은 크기로 자르면서 뒤집어요.",
            "⑤ 반대쪽도 노릇하게 익을 때까지 3~4분 더 굽어요.",
            "⑥ 접시에 옮겨 담고 소금을 조금만 뿌려요.",
        ],
    },
    "소세지야채볶음": {
        "도구": ["프라이팬", "칼", "도마", "주걱"],
        "재료": ["비엔나소세지", "양파", "당근", "케첩", "식용유"],
        "순서": [
            "① 소세지에 칼집을 살짝 넣어요.",
            "② 양파와 당근을 한 입 크기로 잘라요.",
            "③ 프라이팬을 중불로 켜요.",
            "④ 식용유를 아빠숟가락 1숟가락 넣어요.",
            "⑤ 소세지와 채소를 넣고 3분 정도 볶아요.",
            "⑥ 케첩을 아빠숟가락 1~2숟가락 넣고 1분 더 볶아요.",
        ],
    },

    # ───────────── 빵/간식류 ─────────────
    "식빵토스트": {
        "도구": ["프라이팬", "뒤집개", "버터칼"],
        "재료": ["식빵", "버터 또는 마가린"],
        "순서": [
            "① 프라이팬을 약불로 켜요.",
            "② 식빵 한쪽 면에 버터를 얇게 발라요.",
            "③ 버터 바른 쪽을 아래로 해서 프라이팬에 올려요.",
            "④ 노릇노릇해질 때까지 2~3분 굽어요.",
            "⑤ 뒤집어서 반대쪽도 1~2분 굽어요.",
        ],
    },
    "햄치즈토스트": {
        "도구": ["프라이팬", "뒤집개", "버터칼"],
        "재료": ["식빵", "햄", "슬라이스 치즈", "버터"],
        "순서": [
            "① 식빵 한 장 위에 햄과 치즈를 올려요.",
            "② 다른 식빵 한 장을 덮어요.",
            "③ 프라이팬을 약불로 켜요.",
            "④ 프라이팬에 버터를 조금 녹여요.",
            "⑤ 샌드위치를 프라이팬에 올리고 2~3분 굽어요.",
            "⑥ 뒤집어서 2~3분 더 굽고, 치즈가 녹으면 꺼내요.",
        ],
    },
    "샌드위치(간단)": {
        "도구": ["칼", "도마"],
        "재료": ["식빵", "햄", "치즈", "양상추(선택)", "마요네즈"],
        "순서": [
            "① 식빵 한 장 위에 마요네즈를 바릅니다.",
            "② 햄과 치즈를 올려요.",
            "③ 양상추를 손으로 뜯어서 올려요. (선택)",
            "④ 다른 식빵 한 장으로 덮어요.",
            "⑤ 먹기 좋은 크기로 잘라요.",
        ],
    },
    "핫케이크믹스전": {
        "도구": ["볼", "거품기 또는 젓가락", "프라이팬", "주걱"],
        "재료": ["핫케이크믹스", "우유 또는 물", "식용유"],
        "순서": [
            "① 볼에 핫케이크믹스를 넣어요.",
            "② 포장지에 적힌 만큼 우유 또는 물을 넣어요.",
            "③ 거품기나 젓가락으로 잘 섞어요.",
            "④ 프라이팬을 약불로 켜고 식용유를 조금 둘러요.",
            "⑤ 반죽을 국자로 떠서 동그랗게 부어요.",
            "⑥ 기포가 올라오면 뒤집어서 1~2분 더 구워요.",
        ],
    },

    # ───────────── 샐러드/가벼운 메뉴 ─────────────
    "야채샐러드": {
        "도구": ["볼", "칼", "도마"],
        "재료": ["양상추", "오이", "방울토마토", "샐러드소스"],
        "순서": [
            "① 양상추를 손으로 먹기 좋게 뜯어서 볼에 넣어요.",
            "② 오이를 얇게 썰어 넣어요.",
            "③ 방울토마토를 반으로 잘라 넣어요.",
            "④ 샐러드소스를 위에 뿌려요.",
            "⑤ 젓가락으로 가볍게 섞어요.",
        ],
    },
    "오이무침": {
        "도구": ["볼", "칼", "도마"],
        "재료": ["오이", "고춧가루", "식초", "설탕", "소금"],
        "순서": [
            "① 오이를 깨끗이 씻어요.",
            "② 오이를 반달 모양으로 얇게 썰어요.",
            "③ 볼에 오이를 넣어요.",
            "④ 고춧가루, 식초, 설탕을 조금씩 넣어요.",
            "⑤ 소금을 아주 조금만 넣어요.",
            "⑥ 젓가락으로 골고루 버무려요.",
        ],
    },

    # ───────────── 파스타/양식류 ─────────────
    "토마토파스타(간단)": {
        "도구": ["냄비", "프라이팬", "집게", "종이컵"],
        "재료": ["스파게티 면", "시판 토마토소스", "소금", "식용유"],
        "순서": [
            "① 냄비에 물을 종이컵으로 4컵 넣어요.",
            "② 물이 끓으면 소금을 아빠숟가락 반 숟가락 넣어요.",
            "③ 스파게티 면을 넣고 포장지에 적힌 시간만큼 삶아요.",
            "④ 면을 건져서 물기를 빼요.",
            "⑤ 프라이팬을 중불로 켜고 식용유를 조금 넣어요.",
            "⑥ 토마토소스를 넣고 1~2분 데워요.",
            "⑦ 삶은 면을 넣고 2분 정도 더 볶아요.",
        ],
    },

    # ───────────── 계란요리 추가 ─────────────
    "계란찜(전자레인지)": {
        "도구": ["전자레인지용 그릇", "젓가락"],
        "재료": ["계란", "물", "소금"],
        "순서": [
            "① 전자레인지용 그릇에 계란 2개를 깨서 넣어요.",
            "② 물을 계란과 같은 양 정도 넣어요.",
            "③ 소금을 조금 넣고 젓가락으로 잘 섞어요.",
            "④ 전자레인지에 2~3분 돌려요.",
            "⑤ 상태를 보고 덜 익었으면 30초씩 더 돌려요.",
        ],
    },
}


HEALTH_ROUTINES: Dict[str, Dict] = {
    "sit": {
        "id": "sit",
        "name": "앉아서 하는 운동",
        "steps": [
            "의자에 편하게 앉아요.",
            "등을 곧게 펴요.",
            "어깨를 올렸다가 천천히 내려요. 10번 반복해요.",
            "무릎을 하나씩 들어 올렸다가 내려요. 각 10번씩 해요.",
            "깊게 숨을 들이마시고, 천천히 내쉬어요.",
        ],
    },
    "stand": {
        "id": "stand",
        "name": "서서 하는 운동",
        "steps": [
            "두 발을 어깨 넓이로 벌리고 서요.",
            "양팔을 위로 올렸다가 내려요. 10번 반복해요.",
            "제자리에서 무릎을 높게 들며 20번 걸어요.",
            "벽을 짚고 뒤꿈치를 들었다가 내려요. 15번 반복해요.",
            "온몸을 가볍게 털어주며 마무리해요.",
        ],
    },
}


def get_all_recipe_names() -> List[str]:
    return list(BASE_RECIPES.keys())


def suggest_recipes_from_text(task: str) -> List[str]:
    """
    스케줄의 task에서 레시피 이름을 찾아 자동 후보로 사용.
    예: "라면 또는 카레 먹기" → ["라면", "카레"]
    """
    if not task:
        return []
    result = []
    for name in BASE_RECIPES.keys():
        if name in task:
            result.append(name)
    return result


def get_recipe(name: str) -> Dict:
    base = BASE_RECIPES.get(name)
    if not base:
        return {}
    return {
        "id": name,
        "name": name,
        "tools": base.get("도구", []),
        "ingredients": base.get("재료", []),
        "steps": base.get("순서", []),
    }


def get_health_modes() -> List[Dict]:
    return [
        {"id": "sit", "name": "앉아서 하는 운동"},
        {"id": "stand", "name": "서서 하는 운동"},
    ]


def get_health_routine(mode_id: str) -> Dict:
    return HEALTH_ROUTINES.get(mode_id, {})
